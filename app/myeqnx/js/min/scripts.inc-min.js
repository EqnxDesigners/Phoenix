$(document).ready(function(){function e(){0!=$("#user_login").val().length&&0!=$("#user_password").val().length?$.post(urlAjax,{a:"logClientIn",user_login:$("#user_login").val(),user_password:$("#user_password").val()}).done(function(e){"FALSE"===e?($("#form_login").prepend('<div data-alert class="alert-box alert radius">Incorrect !</div>'),i()):(sessionStorage.setItem("clientlogged","true"),o(),location.href="index.php")}).fail(function(){$("#form_login").prepend('<div data-alert class="alert-box alert radius">Une erreur est survenue...</div>'),i()}):($("#form_login").prepend('<div data-alert class="alert-box alert radius">Identifiant & Mot de passe !</div>'),i())}function t(){"true"===sessionStorage.getItem("clientlogged")&&n()}function a(){"true"===sessionStorage.getItem("clientSecureKey")&&$.post(urlAjax,{a:"securityCheck",token:sessionStorage.getItem("clientSecureKey")}).done(function(e){"FALSE"===e&&$.post(urlAjax,{a:"logMeOut"}).done(function(){sessionStorage.clear(),location.href="index.php"})})}function n(){intervalID=setInterval(o,3e4)}function o(){$.post(urlAjax,{a:"secureSynch"}).done(function(e){sessionStorage.setItem("clientSecureKey",e)})}function i(){$(".alert-box").delay(3e3).slideUp("fast")}t(),a(),urlAjax="./functions-ajax.php",$("#top-bar").on("click",".fa",function(){"logout"===$(this).attr("role")&&$.post(urlAjax,{a:"logMeOut"}).done(function(){sessionStorage.clear(),location.href="index.php"})}),$(document).on("keyup",function(t){13==t.keyCode&&e()}),$("#login-box").on("click","#log-me-in",function(){e()}),$("#validation-pwd").on("keyup","#mdp-conf",function(){$("#mdp-ref").val()!==$(this).val()?($(this).add("#mdp-ref").removeClass("match").addClass("notmatch"),$("#valide-account").attr("disabled","disabled")):($(this).add("#mdp-ref").removeClass("notmatch").addClass("match"),$("#valide-account").removeAttr("disabled"))}),$("#verif-box").on("click","#valide-account",function(){var e="",t=!0;if(0!==$('input[name="email"]').val().length?0===$('input[name="societe"]').val().length&&0===$('input[name="nom"]').val().length&&0===$('input[name="prenom"]').val().length&&(e="Une societe, un nom ou un pr√©nom est obligatoire",t=!1):(e="Une e-mail valide est obligatoire",t=!1),t){var a={};$("#form_valid input, #form_valid select").each(function(){a[this.name]=this.value}),$.post(urlAjax,{a:"valideClient",data:a}).done(function(e){"TRUE"===e?location.href="index.php":($("#form_valid").prepend('<div data-alert class="alert-box alert radius">Une erreur est survenue !</div>'),i())}).fail(function(){$("#form_valid").prepend('<div data-alert class="alert-box alert radius">Une erreur est survenue...</div>'),i()})}else $("#form_valid").prepend('<div data-alert class="alert-box alert radius">'+e+"</div>"),i()})}),$(document).foundation();